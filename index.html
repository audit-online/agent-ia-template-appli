<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Agent IA Template ‚Äì Dashboard Pro</title>

  <!-- React + Babel CDN (pas de build n√©cessaire) -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    /* ------- RESET + LAYOUT ------- */
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;color:#333}.app-container{display:flex;height:100vh;overflow:hidden}
    .sidebar{width:400px;background:rgba(255,255,255,.95);backdrop-filter:blur(20px);border-right:1px solid rgba(255,255,255,.2);display:flex;flex-direction:column;box-shadow:2px 0 20px rgba(0,0,0,.1)}
    .sidebar-header{padding:25px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-bottom:1px solid rgba(255,255,255,.1)}
    .sidebar-header h1{font-size:1.5rem;font-weight:700;margin-bottom:8px}
    .sidebar-header p{opacity:.9;font-size:.9rem}
    .status-indicator{display:inline-flex;align-items:center;gap:8px;margin-top:15px;padding:8px 12px;background:rgba(255,255,255,.2);border-radius:20px;font-size:.8rem}
    .status-dot{width:8px;height:8px;border-radius:50%;background:#4ade80;animation:pulse 2s infinite}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
    .chat-section{flex:1;display:flex;flex-direction:column;min-height:0}
    .chat-messages{flex:1;overflow-y:auto;padding:20px;background:#f8fafc}
    .message{margin-bottom:15px;padding:15px;border-radius:12px;max-width:90%;word-wrap:break-word}
    .message.user{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;margin-left:auto;box-shadow:0 4px 12px rgba(102,126,234,.3)}
    .message.agent{background:#fff;border:1px solid #e5e7eb;box-shadow:0 2px 8px rgba(0,0,0,.05)}
    .input-area{padding:20px;background:#fff;border-top:1px solid #e5e7eb}
    .input-group{display:flex;gap:12px;align-items:end}
    .input-wrapper{flex:1;position:relative}
    .input-wrapper textarea{width:100%;min-height:44px;max-height:120px;padding:12px 16px;border:2px solid #e5e7eb;border-radius:12px;font-size:14px;font-family:inherit;resize:none;transition:all .2s}
    .input-wrapper textarea:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,.1)}
    .btn{padding:12px 24px;border:none;border-radius:12px;cursor:pointer;font-weight:600;font-size:14px;transition:all .2s;display:inline-flex;align-items:center;gap:8px}
    .btn-primary{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;box-shadow:0 4px 12px rgba(102,126,234,.3)}
    .btn-primary:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px rgba(102,126,234,.4)}
    .btn-primary:disabled{opacity:.6;cursor:not-allowed}
    .templates-section{border-top:1px solid #e5e7eb;background:#f8fafc;max-height:300px;overflow-y:auto}
    .templates-header{padding:15px 20px;background:#fff;border-bottom:1px solid #e5e7eb;font-weight:600;color:#374151}
    .template-item{padding:15px 20px;border-bottom:1px solid #e5e7eb;background:#fff;transition:all .2s;cursor:pointer}
    .template-item:hover{background:#f3f4f6}
    .template-name{font-weight:600;color:#111827;margin-bottom:4px}
    .template-meta{font-size:12px;color:#6b7280}
    .template-actions{display:flex;gap:8px;margin-top:10px}
    .btn-small{padding:6px 12px;font-size:12px;border-radius:8px}
    .btn-outline{background:transparent;border:1px solid #d1d5db;color:#374151}
    .btn-outline:hover{background:#f3f4f6;border-color:#9ca3af}
    .main-content{flex:1;display:flex;flex-direction:column;background:#fff;position:relative}
    .main-header{padding:20px 30px;background:#fff;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center;box-shadow:0 1px 3px rgba(0,0,0,.05)}
    .main-title{font-size:1.5rem;font-weight:700;color:#111827}
    .main-controls{display:flex;gap:12px;align-items:center}
    .view-toggle{display:flex;background:#f3f4f6;border-radius:10px;padding:4px}
    .view-toggle button{padding:8px 16px;border:none;background:transparent;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s}
    .view-toggle button.active{background:#fff;color:#667eea;box-shadow:0 2px 4px rgba(0,0,0,.1)}
    .preview-area{flex:1;position:relative;overflow:hidden}
    .preview-iframe{width:100%;height:100%;border:none;background:#fff}
    .empty-state{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;color:#6b7280;text-align:center;padding:40px}
    .empty-state-icon{font-size:4rem;margin-bottom:20px;opacity:.5}
    .empty-state h3{font-size:1.5rem;margin-bottom:10px;color:#374151}
    .empty-state p{font-size:1rem;line-height:1.6}
    .code-editor{width:100%;height:100%;border:none;background:#1e1e1e;color:#d4d4d4;font-family:'Monaco','Menlo','Ubuntu Mono',monospace;font-size:14px;padding:20px;resize:none;outline:none}
    .loading-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,.9);display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:10}
    .spinner{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #667eea;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:16px}
    .device-frame{padding:20px;background:#f8fafc;height:100%;display:flex;justify-content:center;align-items:flex-start;overflow:auto}
    .device{background:#333;border-radius:25px;padding:20px;box-shadow:0 10px 40px rgba(0,0,0,.3)}
    .device.desktop{width:90%;max-width:1200px;aspect-ratio:16/10}
    .device.tablet{width:400px;aspect-ratio:4/3}
    .device.mobile{width:280px;aspect-ratio:9/16}
    .device iframe{width:100%;height:100%;border:none;border-radius:15px;background:#fff}
    @media(max-width:1024px){.sidebar{width:350px}}
    @media(max-width:768px){.app-container{flex-direction:column}.sidebar{width:100%;height:50vh}}
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const App = () => {
      const [messages, setMessages] = useState([]);
      const [inputMessage, setInputMessage] = useState('');
      const [templates, setTemplates] = useState([]);
      const [isGenerating, setIsGenerating] = useState(false);
      const [currentTemplate, setCurrentTemplate] = useState(null);
      const [viewMode, setViewMode] = useState('preview');
      const [deviceView, setDeviceView] = useState('desktop');
      const [apiStatus, setApiStatus] = useState('testing');

      /* ‚Äì‚Äì‚Äì‚Äì‚Äì  d√©marrage ‚Äì‚Äì‚Äì‚Äì‚Äì */
      useEffect(() => {
        testAPI();
       setMessages([{
  id: 1,
  type: 'agent',
  content: 'Bonjour ! Je suis votre assistant IA pour la creation de sites web.\n\nJe peux vous aider a:\n- Discuter des besoins de vos clients\n- Vous conseiller sur les meilleures solutions\n- Creer des templates sur mesure\n- Modifier et ameliorer vos projets\n\nComment puis-je vous aider aujourd hui ?'
}]);
      }, []);

      /* ‚Äì‚Äì‚Äì‚Äì‚Äì  test API ‚Äì‚Äì‚Äì‚Äì‚Äì */
      const testAPI = async () => {
        try {
          const r = await fetch('/.netlify/functions/ai-chat', { method: 'GET' });
          if (r.ok) {
            setApiStatus('working');
            setMessages(prev => [...prev, { id: Date.now(), type: 'agent', content: '‚úÖ API Netlify OK ‚Äì pr√™t pour Claude.' }]);
          } else throw new Error('API KO');
        } catch {
          setApiStatus('broken');
          setMessages(prev => [...prev, { id: Date.now(), type: 'agent', content: '‚ùå API indisponible ‚Äì mode test activ√©.' }]);
        }
      };

      /* ‚Äì‚Äì‚Äì‚Äì‚Äì  NOUVEAU : chat conversationnel ‚Äì‚Äì‚Äì‚Äì‚Äì */
const handleConversation = async (userInput) => {
  setIsGenerating(true);
  try {
    const res = await fetch('/.netlify/functions/ai-chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        message: userInput,
        systemPrompt: 'Tu es un assistant IA sp√©cialis√© dans la cr√©ation de sites web. Tu peux discuter de tout ce qui concerne le web design, donner des conseils, expliquer des concepts, et bien s√ªr cr√©er des templates. R√©ponds de mani√®re conversationnelle et amicale. Si l utilisateur veut cr√©er un template, dis-lui clairement qu il doit utiliser des mots comme "cr√©e", "g√©n√®re", "template", "site pour".'
      })
    });
    
    if (!res.ok) throw new Error('Erreur IA');
    const data = await res.json();
    
    setMessages(prev => [...prev, { 
      id: Date.now(), 
      type: 'agent', 
      content: data.response 
    }]);
    
  } catch (error) {
    setMessages(prev => [...prev, { 
      id: Date.now(), 
      type: 'agent', 
      content: 'D√©sol√©, je rencontre un probl√®me technique. Pouvez-vous reformuler votre question ?' 
    }]);
  } finally {
    setIsGenerating(false);
  }
};

/* ‚Äì‚Äì‚Äì‚Äì‚Äì  NOUVEAU : d√©tection du type de demande ‚Äì‚Äì‚Äì‚Äì‚Äì */
const detectRequestType = (message) => {
  const templateKeywords = ['cr√©e', 'cr√©er', 'g√©n√®re', 'g√©n√©rer', 'template', 'site pour', 'site web', 'page pour', 'faire un site'];
  const modifyKeywords = ['change', 'modifie', 'modifier', 'remplace', 'couleur', 'ajoute', 'supprime'];
  
  const lowerMessage = message.toLowerCase();
  
  if (currentTemplate && modifyKeywords.some(keyword => lowerMessage.includes(keyword))) {
    return 'modify';
  }
  
  if (templateKeywords.some(keyword => lowerMessage.includes(keyword))) {
    return 'template';
  }
  
  return 'conversation';
};

  /* ‚Äì‚Äì‚Äì‚Äì‚Äì  envoi message INTELLIGENT ‚Äì‚Äì‚Äì‚Äì‚Äì */
const handleSendMessage = async () => {
  if (!inputMessage.trim()) return;
  const userMessage = { id: Date.now(), type: 'user', content: inputMessage };
  setMessages(prev => [...prev, userMessage]);
  const messageContent = inputMessage;
  setInputMessage('');

  if (apiStatus !== 'working') {
    setMessages(prev => [...prev, { 
      id: Date.now(), 
      type: 'agent', 
      content: 'API non disponible. Activez l API pour discuter avec l IA.' 
    }]);
    return;
  }

  setIsGenerating(true);
  try {
    const res = await fetch('/.netlify/functions/ai-chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        message: messageContent,
        context: currentTemplate ? 'Template actuel: ' + currentTemplate.name : 'Aucun template selectionne',
        systemPrompt: 'Tu es un assistant commercial IA specialise dans la creation de sites web. Tu dois aider les commerciaux a assister leurs clients de maniere naturelle et conversationnelle. REGLES: 1) Reponds toujours de maniere humaine et naturelle comme dans une vraie conversation 2) Pose des questions pour mieux comprendre les besoins 3) Donne des conseils professionnels 4) Si le client veut un template, demande des precisions avant de le creer 5) Sois proactif et suggestif 6) IMPORTANT: Ne cree un template QUE si on te le demande explicitement avec "cree le template" ou "genere le site". Sinon, contente-toi de discuter et conseiller.'
      })
    });
    
    if (!res.ok) throw new Error('Erreur IA');
    const data = await res.json();
    
    // Si la reponse contient du HTML, c'est un template
    if (data.response.includes('<!DOCTYPE') || data.response.includes('<html')) {
      let html = data.response.replace(/```html\n?/g, '').replace(/```\n?/g, '').trim();
      if (!html.includes('</html>')) html += '</body></html>';
      const template = createTemplate(messageContent, html, 'ai');
      setCurrentTemplate(template);
      
      setMessages(prev => [...prev, { 
        id: Date.now(), 
        type: 'agent', 
        content: 'Perfect ! J ai cree le template selon vos specifications. Vous pouvez le voir dans la previsualisation. Voulez-vous des modifications ?' 
      }]);
    } else {
      // Reponse conversationnelle normale
      setMessages(prev => [...prev, { 
        id: Date.now(), 
        type: 'agent', 
        content: data.response 
      }]);
    }
    
  } catch (error) {
    setMessages(prev => [...prev, { 
      id: Date.now(), 
      type: 'agent', 
      content: 'Desole, j ai un petit probleme technique. Pouvez-vous reformuler votre demande ?' 
    }]);
  } finally {
    setIsGenerating(false);
  }
};


/* ‚Äì‚Äì‚Äì‚Äì‚Äì  NOUVEAU : d√©tection des demandes de modification ‚Äì‚Äì‚Äì‚Äì‚Äì */
const isModificationRequest = (message) => {
  const modificationKeywords = [
    'change', 'modifie', 'modifier', 'remplace', 'couleur', 'color', 'photo', 'image', 
    'texte', 'titre', 'ajoute', 'supprime', 'enl√®ve', 'mettre', 'plus', 'moins',
    'rouge', 'bleu', 'vert', 'jaune', 'noir', 'blanc', 'orange', 'violet',
    'plus grand', 'plus petit', 'centrer', 'gauche', 'droite', 'menu', 'bouton',
    'font', 'police', 'taille', 'animation', 'effet', 'am√©liore', 'corrige'
  ];
  
  const lowerMessage = message.toLowerCase();
  return modificationKeywords.some(keyword => lowerMessage.includes(keyword));
};

/* ‚Äì‚Äì‚Äì‚Äì‚Äì  NOUVEAU : modification du template actuel ‚Äì‚Äì‚Äì‚Äì‚Äì */
const modifyCurrentTemplate = async (userInput) => {
  setIsGenerating(true);
  
  try {
    const res = await fetch('/.netlify/functions/ai-chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        message: userInput,
        systemPrompt: 'Tu es un assistant IA sp√©cialis√© dans la modification de templates HTML. CONTEXTE : L utilisateur a d√©j√† un template HTML et souhaite le modifier. TEMPLATE ACTUEL : ' + currentTemplate.htmlCode + ' DEMANDE DE MODIFICATION : ' + userInput + ' INSTRUCTIONS : 1. Analyse le template HTML existant 2. Applique EXACTEMENT la modification demand√©e par l utilisateur 3. Conserve toute la structure et le design existant 4. Ne modifie que ce qui est explicitement demand√© 5. Retourne le HTML complet modifi√© (DOCTYPE ‚Üí </html>) 6. Assure-toi que le HTML reste valide et fonctionnel IMPORTANT : R√©ponds UNIQUEMENT avec le code HTML complet modifi√©, pas d explications.'
      })
    });

    if (!res.ok) throw new Error('Erreur IA');
    
    let modifiedHtml = (await res.json()).response.replace(/```html\n?/g, '').replace(/```\n?/g, '').trim();

    if (!modifiedHtml.includes('</html>')) modifiedHtml += '</body></html>';
    if (!modifiedHtml.includes('<!DOCTYPE')) {
      modifiedHtml = '<!DOCTYPE html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Template Modifi√©</title></head><body>' + modifiedHtml + '</body></html>';
    }

    // Cr√©er une nouvelle version du template
    const modifiedTemplate = {
      ...currentTemplate,
      id: Date.now(),
      name: currentTemplate.name + ' (modifi√©)',
      htmlCode: modifiedHtml,
      source: 'ai-modified',
      parentId: currentTemplate.id
    };

    setTemplates(prev => [modifiedTemplate, ...prev]);
    setCurrentTemplate(modifiedTemplate);
    
    setMessages(prev => [...prev, { 
      id: Date.now(), 
      type: 'agent', 
      content: 'Template modifi√© avec succ√®s ! Les changements ont √©t√© appliqu√©s. Vous pouvez continuer √† demander des modifications ou cr√©er un nouveau template.' 
    }]);

  } catch (error) {
    console.error('Erreur modification:', error);
    setMessages(prev => [...prev, { 
      id: Date.now(), 
      type: 'agent', 
      content: 'Erreur lors de la modification. Pouvez-vous reformuler votre demande ? Par exemple : "Change la couleur en bleu", "Ajoute une section contact", "Modifie le titre principal"' 
    }]);
  } finally {
    setIsGenerating(false);
  }
};

      /* ‚Äì‚Äì‚Äì‚Äì‚Äì  g√©n√©ration IA ultra-exigeante ‚Äì‚Äì‚Äì‚Äì‚Äì */
      const generateWithAI = async (userInput) => {
        setIsGenerating(true);
        try {
          const res = await fetch('/.netlify/functions/ai-chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              message: 'Cr√©e un site haut-de-gamme et interactif pour : ' + userInput,
              systemPrompt: `
Return ONLY a single, valid, complete HTML file (DOCTYPE ‚Üí </html>) respecting :
1. Premium design : modern typography, glassmorphism, smooth animations.
2. Interactive : burger menu, vanilla carousel, validated form, dark/light switch.
3. Responsive : mobile-first, 320 px ‚Üí 4 K.
4. No external links : CSS/JS inline, fonts via @font-face or system stack.
5. Accessibility : semantic tags, aria-labels, WCAG 2.1.
6. SEO : meta, Open-Graph, JSON-LD.
7. Performance : inline critical CSS, lazy images, no comment.
End with </html>, no markdown fences.
`
            })
          });
          if (!res.ok) throw new Error('Erreur IA');
          let html = (await res.json()).response
            .replace(/```html\n?/g, '')
            .replace(/```\n?/g, '')
            .trim();
          if (!html.includes('</html>')) html += '</body></html>';
          if (!html.includes('<!DOCTYPE')) {
            html = '<!DOCTYPE html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Template</title></head><body>' + html + '</body></html>';
          }
          const template = createTemplate(userInput, html, 'ai');
          setCurrentTemplate(template);
          setMessages(prev => [...prev, { id: Date.now(), type: 'agent', content: '‚ú® Template premium g√©n√©r√© ! Pr√©visualisation disponible.' }]);
        } catch (error) {
          console.error('Erreur IA:', error);
          generateTestTemplate(userInput);
        } finally {
          setIsGenerating(false);
        }
      };

      /* ‚Äì‚Äì‚Äì‚Äì‚Äì  template test ‚Äì‚Äì‚Äì‚Äì‚Äì */
      const generateTestTemplate = (userInput) => {
        const html = createTestHTML(userInput);
        const template = createTemplate(userInput, html, 'test');
        setCurrentTemplate(template);
      };

      const createTestHTML = (input) => {
        const type = detectType(input);
        return `<!DOCTYPE html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Template ${type}</title><style>@font-face{font-family:Poppins;src:url(data:font/woff2;base64,...) format('woff2');font-display:swap}*{margin:0;padding:0;box-sizing:border-box}body{font-family:Poppins,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;display:flex;align-items:center;justify-content:center;min-height:100vh}.container{max-width:1200px;margin:auto;text-align:center;padding:40px 20px}.content{background:rgba(255,255,255,.95);color:#2c3e50;padding:60px;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.1)}.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px;margin-top:40px}.card{background:#fff;padding:40px;border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,.1);transition:.3s}.card:hover{transform:translateY(-10px)}.card h3{color:#e74c3c;margin-bottom:15px}</style></head><body><div class="container"><h1>Template ${type.toUpperCase()}</h1><p>Demande : ${input}</p><div class="content"><h2>Template Professionnel</h2><div class="grid"><div class="card"><h3>Design Premium</h3><p>Animations fluides & design responsive.</p></div><div class="card"><h3>Performance</h3><p>Code optimis√© & UX exceptionnelle.</p></div><div class="card"><h3>Multi-device</h3><p>Adapt√© mobiles, tablettes & desktop.</p></div></div></div></div></body></html>`;
      };

      const detectType = (input) => {
        const lower = input.toLowerCase();
        if (lower.includes('restaurant') || lower.includes('cafe') || lower.includes('food')) return 'restaurant';
        if (lower.includes('boutique') || lower.includes('ecommerce') || lower.includes('shop')) return 'ecommerce';
        if (lower.includes('portfolio') || lower.includes('artiste') || lower.includes('photo')) return 'portfolio';
        if (lower.includes('agence') || lower.includes('cabinet') || lower.includes('avocat')) return 'business';
        return 'moderne';
      };

      const createTemplate = (userInput, htmlCode, source) => {
        const template = {
          id: Date.now(),
          name: `Template ${detectType(userInput)} ‚Äì ${new Date().toLocaleTimeString()}`,
          userInput,
          htmlCode,
          source,
          createdAt: new Date()
        };
        setTemplates(prev => [template, ...prev]);
        return template;
      };

      const handleKeyPress = (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          handleSendMessage();
        }
      };

      const downloadTemplate = (template) => {
        const blob = new Blob([template.htmlCode], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `template-${template.id}.html`;
        a.click();
        URL.revokeObjectURL(url);
      };

      return (
        React.createElement('div', { className: 'app-container' },
          React.createElement('div', { className: 'sidebar' },
            React.createElement('div', { className: 'sidebar-header' },
              React.createElement('h1', null, 'Agent IA Template'),
              React.createElement('p', null, 'Dashboard Professionnel'),
              React.createElement('div', { className: 'status-indicator' },
                React.createElement('div', { className: 'status-dot' }),
                apiStatus === 'working' ? 'IA Claude Active' : 'Mode Test'
              )
            ),
            React.createElement('div', { className: 'chat-section' },
              React.createElement('div', { className: 'chat-messages' },
                messages.map(msg => React.createElement('div', { key: msg.id, className: `message ${msg.type}` },
                  React.createElement('div', { style: { whiteSpace: 'pre-line' } }, msg.content)
                )),
                isGenerating && React.createElement('div', { className: 'message agent' },
                  React.createElement('div', { style: { display: 'flex', alignItems: 'center', gap: 10 } },
                    React.createElement('div', { className: 'spinner', style: { width: 20, height: 20 } }),
                    'G√©n√©ration en cours...'
                  )
                )
              ),
              React.createElement('div', { className: 'input-area' },
                React.createElement('div', { className: 'input-group' },
                  React.createElement('div', { className: 'input-wrapper' },
                    React.createElement('textarea', {
                      value: inputMessage,
                      onChange: e => setInputMessage(e.target.value),
                      onKeyPress: handleKeyPress,
                     placeholder: 'Discutez avec l IA ou demandez un template...',
                      disabled: isGenerating
                    })
                  ),
                  React.createElement('button', {
                    onClick: handleSendMessage,
                    disabled: !inputMessage.trim() || isGenerating,
                    className: 'btn btn-primary'
                 }, 'Envoyer')
                )
              )
            ),
            templates.length > 0 && React.createElement('div', { className: 'templates-section' },
              React.createElement('div', { className: 'templates-header' }, `Templates (${templates.length})`),
              templates.slice(0, 5).map(t => React.createElement('div', {
                key: t.id,
                className: 'template-item',
                onClick: () => setCurrentTemplate(t)
              },
                React.createElement('div', { className: 'template-name' }, t.name),
                React.createElement('div', { className: 'template-meta' }, `${t.userInput.substring(0, 50)}‚Ä¶ | ${t.source}`),
                React.createElement('div', { className: 'template-actions' },
                  React.createElement('button', { className: 'btn btn-small btn-outline', onClick: e => { e.stopPropagation(); setCurrentTemplate(t); } }, 'Voir'),
                  React.createElement('button', { className: 'btn btn-small btn-outline', onClick: e => { e.stopPropagation(); downloadTemplate(t); } }, 'DL')
                )
              ))
            )
          ),
          React.createElement('div', { className: 'main-content' },
            React.createElement('div', { className: 'main-header' },
              React.createElement('h1', { className: 'main-title' }, currentTemplate ? currentTemplate.name : 'Pr√©visualisation'),
              React.createElement('div', { className: 'main-controls' },
                React.createElement('div', { className: 'view-toggle' },
                  React.createElement('button', { className: viewMode === 'preview' ? 'active' : '', onClick: () => setViewMode('preview') }, 'Aper√ßu'),
                  React.createElement('button', { className: viewMode === 'code' ? 'active' : '', onClick: () => setViewMode('code') }, 'Code')
                ),
                viewMode === 'preview' && React.createElement('div', { className: 'view-toggle' },
                  React.createElement('button', { className: deviceView === 'desktop' ? 'active' : '', onClick: () => setDeviceView('desktop') }, 'Desktop'),
                  React.createElement('button', { className: deviceView === 'tablet' ? 'active' : '', onClick: () => setDeviceView('tablet') }, 'Tablet'),
                  React.createElement('button', { className: deviceView === 'mobile' ? 'active' : '', onClick: () => setDeviceView('mobile') }, 'Mobile')
                )
              )
            ),
            React.createElement('div', { className: 'preview-area' },
              !currentTemplate && React.createElement('div', { className: 'empty-state' },
                React.createElement('div', { className: 'empty-state-icon' }, 'üé®'),
                React.createElement('h3', null, 'Aucun template s√©lectionn√©'),
                React.createElement('p', null, 'G√©n√©rez un template avec l\'IA ou s√©lectionnez-en un existant pour le voir ici en plein √©cran.')
              ),
              currentTemplate && viewMode === 'code' && React.createElement('textarea', {
                className: 'code-editor',
                value: currentTemplate.htmlCode,
                readOnly: true,
                spellCheck: false
              }),
              currentTemplate && viewMode === 'preview' && React.createElement('div', { className: 'device-frame' },
                React.createElement('div', { className: `device ${deviceView}` },
                  React.createElement('iframe', {
                    key: currentTemplate.id,
                    srcDoc: currentTemplate.htmlCode,
                    title: 'Preview'
                  })
                )
              ),
              isGenerating && React.createElement('div', { className: 'loading-overlay' },
                React.createElement('div', { className: 'spinner' }),
                React.createElement('p', null, 'G√©n√©ration du template en cours‚Ä¶'),
                React.createElement('p', { style: { fontSize: 14, opacity: .7, marginTop: 8 } }, 'IA Claude en action')
              )
            )
          )
        )
      );
    };

    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
</body>
</html>